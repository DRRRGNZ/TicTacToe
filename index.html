<!doctype html>
<html lang="ge">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" media="screen" href="style.css"/>

    <title> Tic-Tac-Toe.com </title>

    <script>
        var current = 0;

        var gewinnBedingungen = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
        ]

        document.addEventListener('DOMContentLoaded', Spielfeldgenerieren)

        function buttongeklickt(element) {   // 0
            var button = element.target;
            if (current === 0) {
                button.setAttribute("class", "spieler0")
                button.innerText = "X";

            } else {
                button.setAttribute("class", "spieler1")
                button.innerText = "O";
            }
            wergewinnt() // 0
            gegenspieler()  // 0
            wergewinnt() // 0
            current = 1 - current// 1
            button.setAttribute("disabled", "true") // 1

        }

        function wergewinnt() {

            var allebuttons = document.querySelectorAll('button')

            var cAs = "spieler" + current

            for (var k = 0; k < 8; k++) {

                if (allebuttons[gewinnBedingungen[k][0]].getAttribute('class') === cAs
                    && allebuttons[gewinnBedingungen[k][1]].getAttribute('class') === cAs
                    && allebuttons[gewinnBedingungen[k][2]].getAttribute('class') === cAs) {

                    spielende();
                }
            }

        }

        function spielende() {
            var allebuttons = document.querySelectorAll("button")

            for (var i = 0; i < 9; i++) {
                allebuttons[i].setAttribute('disabled', 'true');
            }

            Gewinneranzeige();
        }

        function Gewinneranzeige() {
            alert("Spieler " + current + " gewinnt!")
        }

        function Spielfeldgenerieren() {
            document.querySelector('table')?.remove()
            var neueTabelle = document.createElement('table')
            var div = document.getElementById('t1')
            div.appendChild(neueTabelle)

            for (k = 0; k < 3; k++) {
                var zeilenbruch = document.createElement('tr')
                for (i = 0; i < 3; i++) {
                    var button = document.createElement('button')
                    button.addEventListener('click', buttongeklickt)
                    var td = document.createElement('td')
                    td.appendChild(button)
                    zeilenbruch.appendChild(td)
                }
                neueTabelle.appendChild(zeilenbruch)
            }

        }

        function gegenspieler()
        {
            var allebuttons = document.querySelectorAll('button')
            var s1 = "spieler" + 0
            var s2 = "spieler" + 1
            var zufaelligeZahl = Math.floor(Math.random() * 8)
            if( allebuttons[zufaelligeZahl].getAttribute('class') === s1 &&
                allebuttons[zufaelligeZahl].getAttribute('class') === s2    )
            {
              gegenspieler()
            }
            else
            {
                allebuttons[zufaelligeZahl].setAttribute("class", "spieler1")
                allebuttons[zufaelligeZahl].innerText = "O";
                current = 1- current
            }

        }

    </script>
<body>
<h1> Tic Tac Toe </h1>
<div class="Infos">
    <h2> Regeln: </h2>

    <p> 2 Spieler werden benötigt um dieses Spiel zu spielen!</p>
    <p> Der Spieler, der 3 Felder in einer Reihe (diagonal oder Horizontal) mit seiner Form belegt hat, hat
        gewonnen!</p>
    <p> Belegte Felder können nicht mit eineer anderen Form belegt werden!</p>
    <p> Es wird immer nach einander gezogen!</p>
</div>
<div id="t1" class="spielfeld">

</div>
<button type="button" onclick="Spielfeldgenerieren()">Nächste Runde</button>
</body>
</head>
</html>
